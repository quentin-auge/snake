<html>
  <head>
    <style>
      #canvas
      {
        border: solid;
      }
    </style>
  </head>
  <body>
    <canvas id="canvas"  width="800" height="600"></canvas>

    <script>
      canvas = document.getElementById('canvas');
      ctx = canvas.getContext('2d');

      const grid = {
        step: 30,
        width: 30,
        height: 20
      };

      canvas.width = grid.width * grid.step;
      canvas.height = grid.height * grid.step;

      const frameRate = 15;
      frameIndex = 0;

			class Square
      {
        constructor(x, y)
        {
          this.x = x;
          this.y = y;
          this.orientRight();
        }

        orientLeft()
        {
          this.dx = -1;
          this.dy = 0;
        }

        orientUp()
        {
          this.dx = 0;
          this.dy = -1;
        }

        orientRight()
        {
          this.dx = 1;
          this.dy = 0;
        }

        orientDown()
        {
          this.dx = 0;
          this.dy = 1;
        }

        step()
        {
	        this.x = (this.x + this.dx + grid.width) % grid.width
	        this.y = (this.y + this.dy + grid.height) % grid.height
        }

        draw()
        {
          ctx.fillStyle = 'blue';
        	ctx.fillRect(this.x * grid.step, this.y * grid.step, grid.step, grid.step);
        }
      }

      square = new Square(0, 0)

      function loop()
      {
        requestAnimationFrame(loop);

        // Apply frame rate
        frameIndex = (frameIndex + 1) % Math.floor(60 / frameRate)
        if (frameIndex != 0)
          return

        ctx.clearRect(0, 0, canvas.width, canvas.height);

        square.step()
        square.draw()
      }

      requestAnimationFrame(loop);

      function keydown(e)
      {
        switch(e.keyCode)
        {
          case 37:
            square.orientLeft();
            break;
          case 38:
            square.orientUp();
            break;
          case 39:
            square.orientRight();
            break;
          case 40:
            square.orientDown();
            break;
        }
      }

      window.addEventListener('keydown', keydown, false);
    </script>
  </body>
</html>
